<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">

<!-- GAME NAME (shows in browser tab & search) -->
<title>Neon Blaster: Infinity Siege</title>

<!-- SEARCH / IDENTITY -->
<meta name="description" content="Neon Blaster: Infinity Siege is a fast-paced HTML shooting game with bosses, gun upgrades, infinite mode, and saved progress.">
<meta name="keywords" content="html shooting game, browser game, arcade shooter, infinity mode game">
<meta name="author" content="Aditya">

<style>
body {
  background:#111;
  color:white;
  text-align:center;
  font-family:Arial;
}
canvas {
  background:#222;
  border:2px solid white;
  display:none;
  margin:auto;
}
button {
  padding:12px 24px;
  font-size:18px;
  margin:10px;
  cursor:pointer;
}
</style>
</head>
<body>

<h1>ðŸŽ® Neon Blaster: Infinity Siege</h1>

<!-- MAIN MENU -->
<div id="menu">
  <button onclick="startGame('story')">Story Mode</button>
  <button onclick="startGame('infinite')">Infinity Mode</button>
  <button onclick="openShop()">Gun Shop</button>
</div>

<!-- SHOP -->
<div id="shop" style="display:none;">
  <h2>ðŸ›’ Gun Shop</h2>
  <p id="shopInfo"></p>
  <button onclick="buyGun('fast')">Fast Gun (10 coins)</button>
  <button onclick="buyGun('rapid')">Rapid Gun (25 coins)</button>
  <br><br>
  <button onclick="goToMenu()">Back</button>
</div>

<!-- HUD -->
<div id="hud"></div>
<button id="backBtn" onclick="goToMenu()" style="display:none;">Back to Menu</button>

<!-- GAME -->
<canvas id="game" width="800" height="450"></canvas>

<script>
/* ========= CANVAS & UI ========= */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const menu = document.getElementById("menu");
const shop = document.getElementById("shop");
const hud = document.getElementById("hud");
const backBtn = document.getElementById("backBtn");

/* ========= SAVED DATA ========= */
let savedCoins = Number(localStorage.getItem("coins")) || 0;
let unlockedGuns = JSON.parse(localStorage.getItem("guns")) || ["normal"];
let equippedGun = localStorage.getItem("equippedGun") || "normal";

/* ========= GAME STATE ========= */
let STATE = "MENU";
let mode = "";
let player, enemy, bullets, score, level, lives, coins;
let keys = {};
let mouse = {x:0,y:0};

let fireRate = 400;
let lastShot = 0;

const bossMaxHP = 20;

/* ========= MENU ========= */
window.startGame = function(selectedMode){
  mode = selectedMode;
  STATE = "PLAYING";

  player = { x:400, y:350, r:15, speed:4 };
  bullets = [];
  score = 0;
  level = 1;
  lives = 3;
  coins = savedCoins;

  fireRate =
    equippedGun === "rapid" ? 100 :
    equippedGun === "fast" ? 200 : 400;

  spawnEnemy();

  menu.style.display = "none";
  shop.style.display = "none";
  canvas.style.display = "block";
  backBtn.style.display = "inline-block";
};

window.goToMenu = function(){
  STATE = "MENU";
  canvas.style.display = "none";
  backBtn.style.display = "none";
  shop.style.display = "none";
  menu.style.display = "block";
  hud.innerText = "";
};

window.openShop = function(){
  menu.style.display = "none";
  shop.style.display = "block";
  document.getElementById("shopInfo").innerText =
    `Coins: ${savedCoins} | Owned Guns: ${unlockedGuns.join(", ")}`;
};

/* ========= SHOP ========= */
window.buyGun = function(type){
  if(unlockedGuns.includes(type)){
    equippedGun = type;
    localStorage.setItem("equippedGun", equippedGun);
    alert("âœ… Gun Equipped");
    return;
  }

  if(type==="fast" && savedCoins>=10){
    savedCoins -= 10;
    unlockedGuns.push("fast");
    equippedGun = "fast";
  } else if(type==="rapid" && savedCoins>=25){
    savedCoins -= 25;
    unlockedGuns.push("rapid");
    equippedGun = "rapid";
  } else {
    alert("âŒ Not enough coins");
    return;
  }

  localStorage.setItem("coins", savedCoins);
  localStorage.setItem("guns", JSON.stringify(unlockedGuns));
  localStorage.setItem("equippedGun", equippedGun);

  alert("ðŸ”« Gun Purchased!");
  openShop();
};

/* ========= ENEMY ========= */
function spawnEnemy(){
  const isBoss =
    (mode==="story" && level===5) ||
    (mode==="infinite" && level%5===0);

  enemy = {
    x: Math.random()*600+100,
    y: Math.random()*200+50,
    r: isBoss ? 35 : 20,
    vx: 2 + level*0.3,
    vy: 2 + level*0.3,
    hp: isBoss ? bossMaxHP : 1,
    boss: isBoss
  };
}

/* ========= INPUT ========= */
document.addEventListener("keydown",e=>keys[e.key.toLowerCase()]=true);
document.addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);

canvas.addEventListener("mousemove",e=>{
  const r = canvas.getBoundingClientRect();
  mouse.x = e.clientX - r.left;
  mouse.y = e.clientY - r.top;
});

canvas.addEventListener("click",()=>{
  if(STATE!=="PLAYING") return;
  const now = Date.now();
  if(now - lastShot < fireRate) return;
  lastShot = now;

  const a = Math.atan2(mouse.y-player.y, mouse.x-player.x);
  bullets.push({
    x:player.x,
    y:player.y,
    vx:Math.cos(a)*7,
    vy:Math.sin(a)*7
  });
});

/* ========= UPDATE ========= */
function update(){
  if(keys.w && player.y>20) player.y-=player.speed;
  if(keys.s && player.y<430) player.y+=player.speed;
  if(keys.a && player.x>20) player.x-=player.speed;
  if(keys.d && player.x<780) player.x+=player.speed;

  enemy.x+=enemy.vx;
  enemy.y+=enemy.vy;
  if(enemy.x<enemy.r||enemy.x>800-enemy.r) enemy.vx*=-1;
  if(enemy.y<enemy.r||enemy.y>450-enemy.r) enemy.vy*=-1;

  bullets.forEach(b=>{ b.x+=b.vx; b.y+=b.vy; });

  bullets = bullets.filter(b=>{
    if(Math.hypot(b.x-enemy.x,b.y-enemy.y)<enemy.r){
      enemy.hp--;
      return false;
    }
    return true;
  });

  if(enemy.hp<=0){
    score++;
    coins++;
    savedCoins = coins;
    localStorage.setItem("coins", savedCoins);
    level++;
    spawnEnemy();
  }

  if(Math.hypot(player.x-enemy.x,player.y-enemy.y)<player.r+enemy.r){
    lives--;
    enemy.y=50;
    if(lives<=0){
      alert("ðŸ’€ GAME OVER");
      goToMenu();
    }
  }
}

/* ========= DRAW ========= */
function draw(){
  ctx.clearRect(0,0,800,450);

  ctx.fillStyle="cyan";
  ctx.beginPath();
  ctx.arc(player.x,player.y,player.r,0,Math.PI*2);
  ctx.fill();

  ctx.fillStyle=enemy.boss?"purple":"red";
  ctx.beginPath();
  ctx.arc(enemy.x,enemy.y,enemy.r,0,Math.PI*2);
  ctx.fill();

  if(enemy.boss){
    ctx.fillStyle="gray";
    ctx.fillRect(250,10,300,15);
    ctx.fillStyle="lime";
    ctx.fillRect(250,10,(enemy.hp/bossMaxHP)*300,15);
  }

  ctx.fillStyle="yellow";
  bullets.forEach(b=>ctx.fillRect(b.x,b.y,4,4));

  hud.innerText =
    `Mode: ${mode.toUpperCase()} | Level: ${level} | Lives: ${lives} | Coins: ${coins}`;
}

/* ========= LOOP ========= */
function loop(){
  if(STATE==="PLAYING"){
    update();
    draw();
  }
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>

