<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Neon Blaster: Infinity Siege</title>

<meta name="description" content="Neon Blaster: Infinity Siege is a fast-paced HTML shooting game with login system, bosses, gun upgrades, infinite mode, and saved progress.">
<meta name="author" content="Aditya">

<style>
body {
  background:#111;
  color:white;
  text-align:center;
  font-family:Arial;
}
canvas {
  background:#222;
  border:2px solid white;
  display:none;
  margin:auto;
}
button,input {
  padding:10px;
  font-size:16px;
  margin:6px;
}
</style>
</head>
<body>

<h1>ðŸŽ® Neon Blaster: Infinity Siege</h1>

<!-- LOGIN -->
<div id="login">
  <h2>Login / Create Account</h2>
  <input id="username" placeholder="Username"><br>
  <input id="password" placeholder="Password" type="password"><br>
  <button onclick="login()">Login</button>
  <button onclick="register()">Create Account</button>
</div>

<!-- MENU -->
<div id="menu" style="display:none;">
  <p id="welcome"></p>
  <button onclick="startGame('story')">Story Mode</button>
  <button onclick="startGame('infinite')">Infinity Mode</button>
  <button onclick="openShop()">Gun Shop</button>
  <br>
  <button onclick="logout()">Logout</button>
</div>

<!-- SHOP -->
<div id="shop" style="display:none;">
  <h2>ðŸ›’ Gun Shop</h2>
  <p id="shopInfo"></p>
  <button onclick="buyGun('fast')">Fast Gun (10 coins)</button>
  <button onclick="buyGun('rapid')">Rapid Gun (25 coins)</button>
  <br><br>
  <button onclick="goToMenu()">Back</button>
</div>

<div id="hud"></div>
<button id="backBtn" onclick="goToMenu()" style="display:none;">Back to Menu</button>

<canvas id="game" width="800" height="450"></canvas>

<script>
/* ========= ACCOUNT SYSTEM ========= */
let currentUser = null;
let accounts = JSON.parse(localStorage.getItem("accounts")) || {};

function saveAccounts(){
  localStorage.setItem("accounts", JSON.stringify(accounts));
}

function register(){
  const u = username.value;
  const p = password.value;
  if(!u || !p) return alert("Fill all fields");

  if(accounts[u]) return alert("User already exists");

  accounts[u] = {
    password: p,
    coins: 0,
    guns: ["normal"],
    equipped: "normal"
  };
  saveAccounts();
  alert("âœ… Account created!");
}

function login(){
  const u = username.value;
  const p = password.value;

  if(!accounts[u] || accounts[u].password !== p)
    return alert("âŒ Invalid login");

  currentUser = u;
  loginDiv(false);
}

function logout(){
  currentUser = null;
  loginDiv(true);
}

function loginDiv(show){
  document.getElementById("login").style.display = show ? "block" : "none";
  document.getElementById("menu").style.display = show ? "none" : "block";
  if(!show) welcome.innerText = `Welcome, ${currentUser}!`;
}

/* ========= GAME ========= */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const menu = document.getElementById("menu");
const shop = document.getElementById("shop");
const hud = document.getElementById("hud");
const backBtn = document.getElementById("backBtn");

let STATE="MENU", mode="";
let player, enemy, bullets, level, lives;
let keys={}, mouse={x:0,y:0};
let fireRate=400, lastShot=0;
const bossMaxHP=20;

/* ========= MENU ========= */
function startGame(m){
  mode=m; STATE="PLAYING";
  player={x:400,y:350,r:15,speed:4};
  bullets=[]; level=1; lives=3;

  const acc=accounts[currentUser];
  fireRate=acc.equipped==="rapid"?100:acc.equipped==="fast"?200:400;

  spawnEnemy();
  menu.style.display="none";
  shop.style.display="none";
  canvas.style.display="block";
  backBtn.style.display="inline-block";
}

function goToMenu(){
  STATE="MENU";
  canvas.style.display="none";
  backBtn.style.display="none";
  shop.style.display="none";
  menu.style.display="block";
  hud.innerText="";
}

function openShop(){
  menu.style.display="none";
  shop.style.display="block";
  shopInfo.innerText=
    `Coins: ${accounts[currentUser].coins}
     | Guns: ${accounts[currentUser].guns.join(", ")}`;
}

/* ========= SHOP ========= */
function buyGun(type){
  const acc=accounts[currentUser];
  if(acc.guns.includes(type)){
    acc.equipped=type;
    saveAccounts();
    alert("Equipped");
    return;
  }
  if(type==="fast"&&acc.coins>=10){
    acc.coins-=10; acc.guns.push("fast"); acc.equipped="fast";
  } else if(type==="rapid"&&acc.coins>=25){
    acc.coins-=25; acc.guns.push("rapid"); acc.equipped="rapid";
  } else return alert("Not enough coins");

  saveAccounts();
  openShop();
}

/* ========= ENEMY ========= */
function spawnEnemy(){
  const boss=(mode==="story"&&level===5)||(mode==="infinite"&&level%5===0);
  enemy={
    x:Math.random()*600+100,
    y:Math.random()*200+50,
    r:boss?35:20,
    vx:2+level*0.3,
    vy:2+level*0.3,
    hp:boss?bossMaxHP:1,
    boss
  };
}

/* ========= INPUT ========= */
document.addEventListener("keydown",e=>keys[e.key]=true);
document.addEventListener("keyup",e=>keys[e.key]=false);
canvas.addEventListener("mousemove",e=>{
  const r=canvas.getBoundingClientRect();
  mouse.x=e.clientX-r.left;
  mouse.y=e.clientY-r.top;
});
canvas.addEventListener("click",()=>{
  if(STATE!=="PLAYING")return;
  const now=Date.now();
  if(now-lastShot<fireRate)return;
  lastShot=now;
  const a=Math.atan2(mouse.y-player.y,mouse.x-player.x);
  bullets.push({x:player.x,y:player.y,vx:Math.cos(a)*7,vy:Math.sin(a)*7});
});

/* ========= LOOP ========= */
function update(){
  if(keys.w&&player.y>20)player.y-=player.speed;
  if(keys.s&&player.y<430)player.y+=player.speed;
  if(keys.a&&player.x>20)player.x-=player.speed;
  if(keys.d&&player.x<780)player.x+=player.speed;

  enemy.x+=enemy.vx; enemy.y+=enemy.vy;
  if(enemy.x<enemy.r||enemy.x>800-enemy.r)enemy.vx*=-1;
  if(enemy.y<enemy.r||enemy.y>450-enemy.r)enemy.vy*=-1;

  bullets.forEach(b=>{b.x+=b.vx;b.y+=b.vy;});
  bullets=bullets.filter(b=>{
    if(Math.hypot(b.x-enemy.x,b.y-enemy.y)<enemy.r){enemy.hp--;return false;}
    return true;
  });

  if(enemy.hp<=0){
    const reward = enemy.boss ? 5 : 1;
    accounts[currentUser].coins += reward;
    saveAccounts();
    level++;
    spawnEnemy();
  }

  if(Math.hypot(player.x-enemy.x,player.y-enemy.y)<player.r+enemy.r){
    lives--;
    if(lives<=0){alert("GAME OVER");goToMenu();}
  }
}

function draw(){
  ctx.clearRect(0,0,800,450);
  ctx.fillStyle="cyan";
  ctx.beginPath();ctx.arc(player.x,player.y,player.r,0,Math.PI*2);ctx.fill();

  ctx.fillStyle=enemy.boss?"purple":"red";
  ctx.beginPath();ctx.arc(enemy.x,enemy.y,enemy.r,0,Math.PI*2);ctx.fill();

  if(enemy.boss){
    ctx.fillStyle="gray";ctx.fillRect(250,10,300,15);
    ctx.fillStyle="lime";
    ctx.fillRect(250,10,(enemy.hp/bossMaxHP)*300,15);
  }

  ctx.fillStyle="yellow";
  bullets.forEach(b=>ctx.fillRect(b.x,b.y,4,4));

  hud.innerText=`User:${currentUser} | Level:${level} | Lives:${lives} | Coins:${accounts[currentUser].coins}`;
}

function loop(){
  if(STATE==="PLAYING"){update();draw();}
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>


